<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>POL-Based Arbitrage Scanner</title>
  <!-- Load ethers FIRST (global) -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    body { font-family: Arial; margin: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 16px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    .profit { background: #d4edda; }
  </style>
</head>
<body>
  <h2>üåÄ Arbitrage Scanner ‚Äî Modal: 1 POL</h2>
  <button id="scan">Scan Sekarang</button>
  <div id="result"></div>

  <!-- Load modul setelah ethers siap -->
  <script type="module">
    import { scanTriangularArbitrage } from "./core/scanner.js";

    document.getElementById("scan").onclick = async () => {
      document.getElementById("result").innerHTML = "<p>üîç Memindai...</p>";
      const results = await scanTriangularArbitrage(1.0); // minimal 1%

      if (results.length === 0) {
        document.getElementById("result").innerHTML = "<p>‚ùå Tidak ada peluang ‚â•1% ditemukan.</p>";
      } else {
        let html = `<h3>Ditemukan ${results.length} peluang:</h3><table>
          <tr><th>DEX</th><th>Path</th><th>Akhir (POL)</th><th>Profit (%)</th></tr>`;
        for (const r of results) {
          html += `<tr class="profit">
            <td>${r.dex}</td>
            <td>${r.path}</td>
            <td>${r.finalPOL}</td>
            <td>+${r.profitPct}%</td>
          </tr>`;
        }
        html += "</table>";
        document.getElementById("result").innerHTML = html;
      }
    };
  </script>
</body>
</html>
